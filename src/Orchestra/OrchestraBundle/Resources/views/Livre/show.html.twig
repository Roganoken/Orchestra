{% extends '::base.html.twig' %}

{% block stylesheets %}
    {% include "OrchestraOrchestraBundle:Default:stylesheet.html.twig" %}
    <link rel="stylesheet" href="{{ asset('bundles/orchestraorchestra/css/style_bibli_show.css') }}" type="text/css" media="all" />
    
{% endblock %}


{% block header %}
    {% include "OrchestraOrchestraBundle:Default:header.html.twig" %}      
{% endblock %}


{% block contenu %}

<div id="contenu">
    
    {% include "OrchestraOrchestraBundle:Default:menu_gauche.html.twig" %}
 <div id="content">   
  <div id="content_form_edit">
       
      <div id="form_edit">      
       
        <div class="bloc_tuto width_tuto">
    
            <div class="titre_bloc">
                <div class="picto_bibli_titre"><img height="18px;" src="{{ asset ('bundles/orchestraorchestra/img/picto_biblio.png') }}" alt="" /></div>
                <div class="txt_titre_bloc"><p>{{ entity.titre }}</p></div>
            </div>
            
            <div class="bloc_contenu_tuto width_contenu_tuto">  
                
                <div class="record_properties">
                    
                    <div class="illustration">
                        {% if entity.illustration %}
                            <img src="{{ ('bibliotheque/' ~ entity.illustration) | apply_filter('illustration_last') }}" alt="avatar" />
                        {% else %}
                            <img src="{{ ('bibliotheque/default.jpg') | apply_filter('illustration_last') }}" alt="avatar" />
                        {% endif %}

                    </div>
                    
                    <div class="contenu">{{ entity.resume }}</div>

                   {% if entity.dateEmprunt is not null %} 
                    <div class="date">
                         Dernier emprunt : 
                        {{ entity.dateEmprunt| format_date(null, 'fr', 'Europe/Paris', constant('IntlDateFormatter::LONG'))  }} 
                         par {{ entity.user.firstname }} {{ entity.user.lastname }} 
                    </div>
                   {% endif%}

                    <div class="date">STATUT :
                        {% if entity.dateRetour|date('d/m/Y') == "now"|date('d/m/Y') %}
                            disponible !
                        {% elseif entity.dateRetour is not null %}
                             disponible {{ time_diff(entity.dateRetour) }}
                        {% else %}
                             disponible !
                        {% endif%}
                        
                    </div>

                </div>
                
            </div>
        </div> 

       

      </div>            
                
                <ul class="record_actions">
                    
                    <div class="titre_bloc retour_tuto">
                        <div class="picto_bibli_titre"><img height="18px;" src="{{ asset ('bundles/orchestraorchestra/img/picto_biblio.png') }}" alt="" /></div>
                        <div class="txt_titre_bloc">
                            <a href="{{ path('livre') }}">Revenir à la bibliothèque</a>
                        </div>
                    </div>
                    
                            
                        {% if entity.dateRetour|date('d/m/Y') == "now"|date('d/m/Y') %}
                    <div class="titre_bloc retour_tuto reserver">
                        <div class="picto_bibli_titre"><img height="18px;" src="{{ asset ('bundles/orchestraorchestra/img/picto_biblio.png') }}" alt="" /></div>
                        <div class="txt_titre_bloc">
                            <a href="{{ path('livre_reservation', { 'id': entity.id }) }}">Réserver</a>
                        </div>
                    </div>
                    {% endif %}
                    {% if app.security.getToken().getUser() == entity.User and entity.dateRetour|date('d/m/Y') < "now"|date('d/m/Y') %}
                    <div class="titre_bloc retour_tuto reserver">
                        <div class="picto_bibli_titre"><img height="18px;" src="{{ asset ('bundles/orchestraorchestra/img/picto_biblio.png') }}" alt="" /></div>
                        <div class="txt_titre_bloc">
                            <a href="{{ path('livre_rendre', { 'id': entity.id }) }}">Rendre</a>
                        </div>
                    </div>
                     {% endif%}

                    {% if is_granted("ROLE_ADMIN") %}

                        <div class="titre_bloc retour_tuto">
                            <div class="picto_bibli_titre"><img height="18px;" src="{{ asset ('bundles/orchestraorchestra/img/picto_biblio.png') }}" alt="" /></div>
                            <div class="txt_titre_bloc"><a href="{{ path('livre_edit', { 'id': entity.id }) }}">Modifier</a></div>
                        </div>
                        
                       <div class="titre_bloc retour_tuto">
                            <div class="picto_bibli_titre"><img height="18px;" src="{{ asset ('bundles/orchestraorchestra/img/picto_biblio.png') }}" alt="" /></div>
                            <div class="txt_titre_bloc">
                                <form action="{{ path('livre_delete', { 'id': entity.id }) }}" method="post">
                                    {{ form_widget(delete_form) }}
                                    <button class="btn_supp" type="submit">Supprimer</button>
                                </form>
                            </div>
                        </div>

                    {% endif %}
                </ul>
                
                

    
    </div>
 
 
 </div>
 
 </div>  
{% endblock %}