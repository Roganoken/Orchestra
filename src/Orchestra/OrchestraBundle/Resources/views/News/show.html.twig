{% extends '::base.html.twig' %}

{% block stylesheets %}
    {% include "OrchestraOrchestraBundle:Default:stylesheet.html.twig" %}
    <link rel="stylesheet" href="{{ asset('bundles/orchestraorchestra/css/style_edit_profil.css') }}" type="text/css" media="all" />
{% endblock %}


{% block header %}
    {% include "OrchestraOrchestraBundle:Default:header.html.twig" %}      
{% endblock %}


{% block contenu %}

<div id="contenu">
    
    {% include "OrchestraOrchestraBundle:Default:menu_gauche.html.twig" %}
    
    <h1>Actualités</h1>

<table class="record_properties">
    <tbody>
        <tr>
            <th>Titre</th>
            <td>{{ entity.title }}</td>
        </tr>
        <tr>
            <th>Contenu</th>
            <td>{{ entity.content }}</td>
        </tr>
        <tr>
            <th>Ajouté :</th>
            <td>{{ entity.created|format_datetime(null, 'fr', 'Europe/Paris', constant('IntlDateFormatter::LONG'), constant('IntlDateFormatter::SHORT')) }}</td>
        </tr>
        <tr>
            <th>Modifié : </th>
            <td>{{ time_diff(entity.updated) }}</td>
        </tr>
    </tbody>
</table>

<ul class="record_actions">
    <li>
        <a href="{{ path('news') }}">
            Revenir à la liste
        </a>
    </li>
    {% if is_granted("ROLE_ADMIN") or entity.User.id == app.security.getToken().getUser().getId() %}
    <li>
        <a href="{{ path('news_edit', { 'id': entity.id }) }}">
            Modifier
        </a>
    </li>
    <li>
        <form action="{{ path('news_delete', { 'id': entity.id }) }}" method="post">
            {{ form_widget(delete_form) }}
            <button type="submit">Supprimer</button>
        </form>
    </li>
    {% endif %}
</ul>
    <br />
    <h1>{% if entity.Commentaire|length > 0 %}{{ entity.Commentaire|length }}{% endif %} Commentaires</h1>
{% if entity.Commentaire|length > 0 %}
    <ul>
    {% for commentaire in entity.Commentaire|reverse %}
        <li>
                    {% if commentaire.User.photo %}
                    <img width="18" height="18" src="{{ ('avatar/' ~ commentaire.User.photo) | apply_filter('my_thumb') }}" />
                    {% else %}
                    <img width="18" height="18" src="{{ ('avatar/default.jpg') | apply_filter('my_thumb') }}" />
                    {% endif %}
        <a href="{{ path('OrchestraOrchestraBundle_profil', { 'id': commentaire.User.id }) }}">{{ commentaire.User.firstname }} {{ commentaire.User.lastname }}</a> 
        dit : {{ commentaire.contenu }} [{{ time_diff(commentaire.created) }}]
        {% if app.security.getToken().getUser() == commentaire.User %}
        <a href="{{ path('news_commentaire_delete', { 'actualite': entity.id, 'id': commentaire.id }) }}">X</a>
        {% endif %}
        </li>
    {% endfor %}
    </ul>
{% else %}
pas encore de commentaires.    
{% endif %}
 {% include 'OrchestraOrchestraBundle:News:addCommentaire.html.twig' %}
    
</div>

 {% include 'FOSCommentBundle:Thread:async.html.twig' with {'id': entity.id} %}   
    
{% endblock %}